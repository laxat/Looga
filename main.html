<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <title>Looga Demo</title>
      <link rel="icon" type="image/x-icon" href="favicon.ico">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
      <link rel="stylesheet" href="css/styles.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
      <script src="https://unpkg.com/blockly"></script>
      <script src="js/depedancies/acorn_interpreter.js"></script>
      <script src="msg/lang.js"></script>
      
  </head>
  <body>

    <div class="m-4">
      <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
          <div class="container-fluid">
              <a href="index.html" class="navbar-brand"><img class="logo" src="common/logo.png"/></a>
              <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                  <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarCollapse">
                  <div class="navbar-nav">
                    <div class="nav-item dropdown">
                      <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="fa fa-globe" aria-hidden="true"></i></a>
                      <div class="dropdown-menu">
                          <a href="#" class="dropdown-item" onclick="changeLanguage('en')">English</a>
                          <a href="#" class="dropdown-item" onclick="changeLanguage('ar')">عربى</a>
                      </div>
                  </div>
                    <div class="nav-item dropdown">
                        <a href="#" id="file" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">File</a>
                        <div class="dropdown-menu">
                            <a href="#new" id="new" class="dropdown-item">New Project</a>
                            <a href="#" id="save" class="dropdown-item">Save Project</a>
                            <a href="#" id="load" class="dropdown-item" onclick="document.getElementById('impFile').click();">Load Project</a>
                        </div>
                    </div>
                  </div>
              </div>
          </div>
      </nav>
    </div>
    <div id="newModal" class="modal">

      <!-- Modal content -->
      <div class="modal-content">
        <p>Select Your Character</p>
        <div class="row">
          <div class="column">
            <img src="common/sprites/looga.png" alt="robot" onclick="selectCharacter('robot')" style="width:100px;height:150px;">
          </div>
          <div class="column">
            <img src="common/sprites/bluebot/blue-select.png" alt="blue" onclick="selectCharacter('blue')">
          </div>
          <div class="column">
            <img src="common/sprites/cat/cat-select.png" alt="cat" onclick="selectCharacter('cat')">
          </div>
          <div class="column">
            <img src="common/sprites/redbot/red-select.png" alt="red" onclick="selectCharacter('red')">
          </div>
        </div>
      </div>
    
    </div>
    <div class="content"></div>
    <div class="game-control">
      <table width="500">
        <tr>
          <td>
            <button id="runButton" class="primary" title="Run">
              <span style="margin-right: 4px;"><i class="fa fa-play" aria-hidden="true"></i></span>Run 
            </button>
            <button id="resetButton" class="primary" style="display: none" title="Reset">
              Reset 
            </button>
          </td>
          
          <td>
            <button id="stepButton" class="primary">
              <span style="margin-right: 5px;"><i class="fa fa-forward" aria-hidden="true"></i></span> Take Step
            </button>
          </td>
          <td style="width: 190px; text-align: center; vertical-align: top;"></td>
          <td style="width: 15px;">
            <img id="spinner" style="visibility: hidden;" src="common/loading.gif" height=15 width=15>
          </td>
          <td id="view">
            View 
          </td>
          
        </tr>
        <tr>
          <td style="width: 100px; text-align: center; vertical-align: top;"></td>
          <td><input id="impFile" type="file" style="display: none" onchange="sendBlocks(this);"/></td>
        </tr>
      </table>
      <div id="visualization" text-align="left">
        <canvas id="canvas1"></canvas> 
        <div id="capacityBubble">
          <div id="capacity"></div>
        </div>
      </div>
    </div>
    <div>
      <table width="886" >
        <tr>
          <td style=" margin-left: 2250px; vertical-align: top; left: 30px;">
            Code
          </td>
        </tr>
      </table>
      <div id="blocklyDiv"></div>
    </div>
      

      <xml xmlns="https://developers.google.com/blockly/xml" id="en-toolbox" style="display:none">
          <category name="Move" css-icon="customIcon fa fa-arrow-left" categorystyle="text_category">
            <block type="robot_moveRight"></block>
            <block type="robot_moveLeft"></block>
            <block type="robot_moveDownward"></block>
            <block type="robot_moveUpward"></block>
          </category>
          <category name="Scene" css-icon="customIcon fa fa-picture-o" hidden="true" categorystyle="logic_category">
            <block type="robot_back"></block>
            <block type="robot_light"></block>
          </category>
          <category name="Loops" css-icon="customIcon fa fa-refresh" hidden="true" categorystyle="loop_category">
            <block type="robot_loops">
              <value name="TIMES">
                <block type="math_number">
                  <field name="NUM">10</field>
                </block>
            </block>
            </value>
            </block>
          </category>
        </xml>


        <xml xmlns="https://developers.google.com/blockly/xml" id="ar-toolbox" style="display:none">
          <category name="الحركة"  css-icon="customIcon fa fa-arrow-left" categorystyle="text_category">
            <block type="robot_moveRight"></block>
            <block type="robot_moveLeft" hidden="true"></block>
            <block type="robot_moveDownward"></block>
            <block type="robot_moveUpward"></block>
          </category>
          <category name="المشهد"  css-icon="customIcon fa fa-picture-o" categorystyle="logic_category">
            <block type="robot_back"></block>
            <block type="robot_light"></block>
          </category>
          <category name="الحلقات"  css-icon="customIcon fa fa-refresh" categorystyle="loop_category">
            <block type="robot_loops">
              <value name="TIMES">
                <block type="math_number">
                  <field name="NUM">10</field>
                </block>
            </block>
            </value>
            </block>
          </category>
        </xml>

        
        <script src="js/translate.js"></script>
        <script src="js/toolbox/toolbox.js"></script>
        <script src="js/toolbox/categories.js"></script>
        <script src="js/blocks.js"></script>
        <script src="js/game.js"></script>  
        <script>
          if(window.location.hash === "#new"){
            startNewGame(); 
            window.location.hash = ""; 
          }
          if (window.performance.navigation.type == window.performance.navigation.TYPE_RELOAD) {
              console.info( "This page is reloaded");
              loadFromLocal();  
          } else {
              console.info( "This page is not reloaded");
              localStorage.removeItem("blocks"); 
              localStorage.removeItem("player"); 
          }
        </script>
      </div> 
    </body>
</html>